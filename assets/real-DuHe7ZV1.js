import{r as S,S as Se,b as Ge,f as he,R as P,L as Z,e as Je,A as Ze,i as ie,h as Ve,k as Te,E as Xe,l as oe,m as Ye,n as Ue,C as et,o as tt,p as K,q as nt,s as rt,G as it,t as at,v as we,w as st,X as ye,Y as xe,x as ot,j as e,y as ke,z as Be,B as Ae,T as Ce,D as lt,F as Ne,g as ct,a as pe,d as dt,u as ut,W as ht,c as pt}from"./index-KvUfb6bY.js";function H(t){"@babel/helpers - typeof";return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},H(t)}function mt(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function ft(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_e(r.key),r)}}function yt(t,n,i){return n&&ft(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xt(t,n,i){return n=le(n),gt(t,qe()?Reflect.construct(n,i||[],le(t).constructor):n.apply(t,i))}function gt(t,n){if(n&&(H(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vt(t)}function vt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qe=function(){return!!t})()}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},le(t)}function bt(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&me(t,n)}function me(t,n){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},me(t,n)}function Re(t,n,i){return n=_e(n),n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function _e(t){var n=jt(t,"string");return H(n)=="symbol"?n:n+""}function jt(t,n){if(H(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,n);if(H(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var de=function(t){function n(){return mt(this,n),xt(this,n,arguments)}return bt(n,t),yt(n,[{key:"render",value:function(){return null}}])}(S.Component);Re(de,"displayName","ZAxis");Re(de,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var St=["option","isActive"];function V(){return V=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},V.apply(this,arguments)}function wt(t,n){if(t==null)return{};var i=At(t,n),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)r=o[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function At(t,n){if(t==null)return{};var i={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(n.indexOf(r)>=0)continue;i[r]=t[r]}return i}function Nt(t){var n=t.option,i=t.isActive,r=wt(t,St);return typeof n=="string"?S.createElement(Se,V({option:S.createElement(Ge,V({type:n},r)),isActive:i,shapeType:"symbols"},r)):S.createElement(Se,V({option:n,isActive:i,shapeType:"symbols"},r))}function $(t){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$(t)}function X(){return X=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},X.apply(this,arguments)}function Pe(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),i.push.apply(i,r)}return i}function z(t){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Pe(Object(i),!0).forEach(function(r){q(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Pe(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function Pt(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Me(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qe(r.key),r)}}function Mt(t,n,i){return n&&Me(t.prototype,n),i&&Me(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ft(t,n,i){return n=ce(n),Ot(t,Ee()?Reflect.construct(n,i||[],ce(t).constructor):n.apply(t,i))}function Ot(t,n){if(n&&($(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return It(t)}function It(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ee(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ee=function(){return!!t})()}function ce(t){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ce(t)}function zt(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&fe(t,n)}function fe(t,n){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},fe(t,n)}function q(t,n,i){return n=Qe(n),n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function Qe(t){var n=Tt(t,"string");return $(n)=="symbol"?n:n+""}function Tt(t,n){if($(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,n);if($(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Y=function(t){function n(){var i;Pt(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i=Ft(this,n,[].concat(a)),q(i,"state",{isAnimationFinished:!1}),q(i,"handleAnimationEnd",function(){i.setState({isAnimationFinished:!0})}),q(i,"handleAnimationStart",function(){i.setState({isAnimationFinished:!1})}),q(i,"id",rt("recharts-scatter-")),i}return zt(n,t),Mt(n,[{key:"renderSymbolsStatically",value:function(r){var a=this,o=this.props,c=o.shape,f=o.activeShape,d=o.activeIndex,s=he(this.props,!1);return r.map(function(l,p){var h=d===p,m=h?f:c,g=z(z({},s),l);return P.createElement(Z,X({className:"recharts-scatter-symbol",key:"symbol-".concat(l==null?void 0:l.cx,"-").concat(l==null?void 0:l.cy,"-").concat(l==null?void 0:l.size,"-").concat(p)},Je(a.props,l,p),{role:"img"}),P.createElement(Nt,X({option:m,isActive:h,key:"symbol-".concat(p)},g)))})}},{key:"renderSymbolsWithAnimation",value:function(){var r=this,a=this.props,o=a.points,c=a.isAnimationActive,f=a.animationBegin,d=a.animationDuration,s=a.animationEasing,l=a.animationId,p=this.state.prevPoints;return P.createElement(Ze,{begin:f,duration:d,isActive:c,easing:s,from:{t:0},to:{t:1},key:"pie-".concat(l),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var m=h.t,g=o.map(function(j,x){var w=p&&p[x];if(w){var b=ie(w.cx,j.cx),v=ie(w.cy,j.cy),M=ie(w.size,j.size);return z(z({},j),{},{cx:b(m),cy:v(m),size:M(m)})}var y=ie(0,j.size);return z(z({},j),{},{size:y(m)})});return P.createElement(Z,null,r.renderSymbolsStatically(g))})}},{key:"renderSymbols",value:function(){var r=this.props,a=r.points,o=r.isAnimationActive,c=this.state.prevPoints;return o&&a&&a.length&&(!c||!Ve(c,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.points,c=a.xAxis,f=a.yAxis,d=a.children,s=Te(d,Xe);return s?s.map(function(l,p){var h=l.props,m=h.direction,g=h.dataKey;return P.cloneElement(l,{key:"".concat(m,"-").concat(g,"-").concat(o[p]),data:o,xAxis:c,yAxis:f,layout:m==="x"?"vertical":"horizontal",dataPointFormatter:function(x,w){return{x:x.cx,y:x.cy,value:m==="x"?+x.node.x:+x.node.y,errorVal:oe(x,w)}}})}):null}},{key:"renderLine",value:function(){var r=this.props,a=r.points,o=r.line,c=r.lineType,f=r.lineJointType,d=he(this.props,!1),s=he(o,!1),l,p;if(c==="joint")l=a.map(function(v){return{x:v.cx,y:v.cy}});else if(c==="fitting"){var h=Ye(a),m=h.xmin,g=h.xmax,j=h.a,x=h.b,w=function(M){return j*M+x};l=[{x:m,y:w(m)},{x:g,y:w(g)}]}var b=z(z(z({},d),{},{fill:"none",stroke:d&&d.fill},s),{},{points:l});return P.isValidElement(o)?p=P.cloneElement(o,b):Ue(o)?p=o(b):p=P.createElement(et,X({},b,{type:f})),P.createElement(Z,{className:"recharts-scatter-line",key:"recharts-scatter-line"},p)}},{key:"render",value:function(){var r=this.props,a=r.hide,o=r.points,c=r.line,f=r.className,d=r.xAxis,s=r.yAxis,l=r.left,p=r.top,h=r.width,m=r.height,g=r.id,j=r.isAnimationActive;if(a||!o||!o.length)return null;var x=this.state.isAnimationFinished,w=tt("recharts-scatter",f),b=d&&d.allowDataOverflow,v=s&&s.allowDataOverflow,M=b||v,y=K(g)?this.id:g;return P.createElement(Z,{className:w,clipPath:M?"url(#clipPath-".concat(y,")"):null},b||v?P.createElement("defs",null,P.createElement("clipPath",{id:"clipPath-".concat(y)},P.createElement("rect",{x:b?l:l-h/2,y:v?p:p-m/2,width:b?h:h*2,height:v?m:m*2}))):null,c&&this.renderLine(),this.renderErrorBar(),P.createElement(Z,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!j||x)&&nt.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:a.curPoints}:r.points!==a.curPoints?{curPoints:r.points}:null}}])}(S.PureComponent);q(Y,"displayName","Scatter");q(Y,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!it.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});q(Y,"getComposedData",function(t){var n=t.xAxis,i=t.yAxis,r=t.zAxis,a=t.item,o=t.displayedData,c=t.xAxisTicks,f=t.yAxisTicks,d=t.offset,s=a.props.tooltipType,l=Te(a.props.children,at),p=K(n.dataKey)?a.props.dataKey:n.dataKey,h=K(i.dataKey)?a.props.dataKey:i.dataKey,m=r&&r.dataKey,g=r?r.range:de.defaultProps.range,j=g&&g[0],x=n.scale.bandwidth?n.scale.bandwidth():0,w=i.scale.bandwidth?i.scale.bandwidth():0,b=o.map(function(v,M){var y=oe(v,p),U=oe(v,h),R=!K(m)&&oe(v,m)||"-",ee=[{name:K(n.dataKey)?a.props.name:n.name||n.dataKey,unit:n.unit||"",value:y,payload:v,dataKey:p,type:s},{name:K(i.dataKey)?a.props.name:i.name||i.dataKey,unit:i.unit||"",value:U,payload:v,dataKey:h,type:s}];R!=="-"&&ee.push({name:r.name||r.dataKey,unit:r.unit||"",value:R,payload:v,dataKey:m,type:s});var L=we({axis:n,ticks:c,bandSize:x,entry:v,index:M,dataKey:p}),W=we({axis:i,ticks:f,bandSize:w,entry:v,index:M,dataKey:h}),G=R!=="-"?r.scale(R):j,u=Math.sqrt(Math.max(G,0)/Math.PI);return z(z({},v),{},{cx:L,cy:W,x:L-u,y:W-u,xAxis:n,yAxis:i,zAxis:r,width:2*u,height:2*u,size:G,node:{x:y,y:U,z:R},tooltipPayload:ee,tooltipPosition:{x:L,y:W},payload:v},l&&l[M]&&l[M].props)});return z({points:b},d)});var kt=st({chartName:"ScatterChart",GraphicalChild:Y,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:ye},{axisType:"yAxis",AxisComp:xe},{axisType:"zAxis",AxisComp:de}],formatAxisMap:ot});function Bt({I:t,Q:n,color:i="#2563eb",size:r=300}){const a=[],o=Math.max(1,Math.floor(t.length/500));for(let d=0;d<t.length;d+=o)a.push({i:t[d],q:n[d]});const c=Math.max(...a.map(d=>Math.max(Math.abs(d.i),Math.abs(d.q)))),f=[-(c*1.2),c*1.2];return e.jsx("div",{className:"constellation-container",children:e.jsx(ke,{width:"100%",height:r,children:e.jsxs(kt,{margin:{top:10,right:20,bottom:20,left:10},children:[e.jsx(Be,{strokeDasharray:"3 3",stroke:"#d8dbe5"}),e.jsx(ye,{dataKey:"i",type:"number",domain:f,stroke:"#5c6178",fontSize:11,name:"I",label:{value:"I",position:"bottom",offset:5,fill:"#2563eb",fontSize:11},tickFormatter:d=>d.toFixed(2)}),e.jsx(xe,{dataKey:"q",type:"number",domain:f,stroke:"#5c6178",fontSize:11,name:"Q",label:{value:"Q",angle:-90,position:"insideLeft",fill:"#dc2626",fontSize:11},tickFormatter:d=>d.toFixed(2)}),e.jsx(Ae,{x:0,stroke:"#b0b5c5"}),e.jsx(Ae,{y:0,stroke:"#b0b5c5"}),e.jsx(Ce,{contentStyle:{background:"#ffffff",border:"1px solid #d8dbe5",borderRadius:8,fontSize:12,fontFamily:"JetBrains Mono, monospace"},content:({active:d,payload:s})=>{if(!d||!s||s.length===0)return null;const l=s[0].payload;return e.jsxs("div",{style:{background:"#ffffff",border:"1px solid #d8dbe5",borderRadius:8,padding:"8px 12px",fontSize:12,fontFamily:"JetBrains Mono, monospace"},children:[e.jsxs("div",{style:{color:"#2563eb"},children:["I: ",l.i.toFixed(4)]}),e.jsxs("div",{style:{color:"#dc2626"},children:["Q: ",l.q.toFixed(4)]})]})}}),e.jsx(Y,{data:a,fill:i,fillOpacity:.6,r:2,isAnimationActive:!1})]})})})}function ae({frequencies:t,magnitudesDb:n,height:i=200,freqUnit:r="Hz",color:a="#2563eb",yDomain:o=[-80,0],traces:c=null,data:f=null}){const d=f||(()=>{const p=Math.max(1,Math.floor(t.length/2e3)),h=[];for(let m=0;m<t.length;m+=p)h.push({f:t[m],mag:n[m]});return h})(),s=l=>Math.round(r==="MHz"?l/1e6:r==="kHz"?l/1e3:l);return e.jsx(ke,{width:"100%",height:i,children:e.jsxs(lt,{data:d,margin:{top:5,right:20,bottom:20,left:10},children:[e.jsx(Be,{strokeDasharray:"3 3",stroke:"#d8dbe5"}),e.jsx(ye,{dataKey:"f",stroke:"#5c6178",fontSize:11,tickFormatter:s,label:{value:`Frequency (${r})`,position:"insideBottom",offset:-10,fill:"#5c6178",fontSize:11}}),e.jsx(xe,{stroke:"#5c6178",fontSize:11,domain:o,tickFormatter:l=>`${l}`,label:{value:"dB",angle:-90,position:"insideLeft",fill:"#5c6178",fontSize:11}}),e.jsx(Ce,{contentStyle:{background:"#ffffff",border:"1px solid #d8dbe5",borderRadius:8,fontSize:12,fontFamily:"JetBrains Mono, monospace"},labelFormatter:l=>`${s(l)} ${r}`,formatter:(l,p)=>[`${l.toFixed(1)} dB`,p]}),c?c.map(l=>e.jsx(Ne,{type:"monotone",dataKey:l.key,stroke:l.color,strokeWidth:1.5,dot:!1,name:l.label,isAnimationActive:!1},l.key)):e.jsx(Ne,{type:"monotone",dataKey:"mag",stroke:a,strokeWidth:1.5,dot:!1,name:"Magnitude",isAnimationActive:!1})]})})}const Ct=2*Math.PI;function Fe(t,n){const i=De(t.length),r=new Float64Array(i),a=new Float64Array(i);for(let s=0;s<t.length;s++)r[s]=t[s];Ke(r,a);const o=i/2,c=new Float64Array(o),f=new Float64Array(o),d=2/i;for(let s=0;s<o;s++)c[s]=Math.sqrt(r[s]*r[s]+a[s]*a[s])*d,f[s]=s*n/i;return{magnitudes:c,frequencies:f}}function Oe(t,n,i){const r=De(t.length),a=new Float64Array(r),o=new Float64Array(r);for(let s=0;s<t.length;s++)a[s]=t[s],o[s]=n[s];Ke(a,o);const c=new Float64Array(r),f=new Float64Array(r),d=1/r;for(let s=0;s<r;s++){const l=(s+r/2)%r;c[s]=Math.sqrt(a[l]*a[l]+o[l]*o[l])*d,f[s]=(s-r/2)*i/r}return{magnitudes:c,frequencies:f}}function se(t,n=-80){const i=Math.max(...t),r=new Float64Array(t.length);for(let a=0;a<t.length;a++){const o=t[a]>0?20*Math.log10(t[a]/i):n;r[a]=Math.max(o,n)}return r}function De(t){let n=1;for(;n<t;)n<<=1;return n}function Ke(t,n,i){const r=t.length;for(let a=1,o=0;a<r;a++){let c=r>>1;for(;o&c;)o^=c,c>>=1;o^=c,a<o&&([t[a],t[o]]=[t[o],t[a]],[n[a],n[o]]=[n[o],n[a]])}for(let a=2;a<=r;a<<=1){const o=-Ct/a,c=Math.cos(o),f=Math.sin(o);for(let d=0;d<r;d+=a){let s=1,l=0;for(let p=0;p<a/2;p++){const h=d+p,m=d+p+a/2,g=s*t[m]-l*n[m],j=s*n[m]+l*t[m];t[m]=t[h]-g,n[m]=n[h]-j,t[h]+=g,n[h]+=j;const x=s*c-l*f;l=s*f+l*c,s=x}}}}function Ie(t,n,i,r=101){const a=n/i,o=Math.floor(r/2),c=new Float64Array(r);let f=0;for(let s=0;s<r;s++){const l=s-o;l===0?c[s]=2*Math.PI*a:c[s]=Math.sin(2*Math.PI*a*l)/l,c[s]*=.42-.5*Math.cos(2*Math.PI*s/(r-1))+.08*Math.cos(4*Math.PI*s/(r-1)),f+=c[s]}for(let s=0;s<r;s++)c[s]/=f;const d=new Float64Array(t.length);for(let s=0;s<t.length;s++){let l=0;for(let p=0;p<r;p++){const h=s-o+p;h>=0&&h<t.length&&(l+=t[h]*c[p])}d[s]=l}return d}const I={input:"#1aad50",I:"#2563eb",Q:"#dc2626",output:"#7c3aed"};function qt(t,n,i=2e3){const r=Math.max(1,Math.floor(t.length/i)),a=[];for(let o=0;o<t.length;o+=r){const c={t:t[o]};for(const[f,d]of Object.entries(n))c[f]=d[o];a.push(c)}return a}function ze(t,n,i=500){const r=Math.max(1,Math.floor(t.length/i)),a=[];for(let o=0;o<t.length;o+=r)a.push({f:t[o],mag:n[o]});return a}function Rt(){const[t,n]=S.useState("fm"),[i,r]=S.useState(100),a=i*1e6,[o,c]=S.useState(15e3),[f]=S.useState(75e3),[d]=S.useState(.8),s=1e4,l=a/s,p=o/l,h=5e4,m=.05,[g,j]=S.useState(1e5),[x,w]=S.useState(21),[b,v]=S.useState(.05),M=g/l/2,y=S.useMemo(()=>{const u=ct(h,m);let A;const E=f/o;t==="fm"?A=pe("fm",u,{carrierFreq:s,modulatingFreq:p,modulationIndex:E/l}):t==="am"?A=pe("am",u,{carrierFreq:s,modulatingFreq:p,modulationIndex:d}):A=pe("cosine",u,{frequency:s,amplitude:1});const{I:k,Q:B}=dt(A,u,s);if(b>0)for(let N=0;N<k.length;N++){const Q=Math.random()||1e-10,D=Math.random(),re=Math.sqrt(-2*Math.log(Q))*Math.cos(2*Math.PI*D),J=Math.sqrt(-2*Math.log(Q))*Math.sin(2*Math.PI*D);k[N]+=b*re,B[N]+=b*J}const C=Ie(k,M,h,x),_=Ie(B,M,h,x),F=ut(C,_,u,s),te=Fe(A,h),ne=se(te.magnitudes),T=Oe(k,B,h),He=se(T.magnitudes),ge=Oe(C,_,h),$e=se(ge.magnitudes),ve=Fe(F,h),Le=se(ve.magnitudes);return{t:u,inputSignal:A,rawI:k,rawQ:B,filteredI:C,filteredQ:_,reconstructed:F,inputSpectrum:{frequencies:te.frequencies.map(N=>N*l),db:ne},rawIQSpectrum:{frequencies:T.frequencies.map(N=>N*l),db:He},filteredIQSpectrum:{frequencies:ge.frequencies.map(N=>N*l),db:$e},reconstructedSpectrum:{frequencies:ve.frequencies.map(N=>N*l),db:Le},scaleFactor:l,reconstructionSNR:(()=>{const N=Math.floor(x/2),Q=N+10,D=A.length-N-10;if(D<=Q)return"0.0";let re=0,J=0;for(let O=Q;O<D;O++)re+=A[O]*F[O],J+=F[O]*F[O];const We=J>0?re/J:1;let be=0,ue=0;for(let O=Q;O<D;O++){be+=A[O]*A[O];const je=A[O]-We*F[O];ue+=je*je}return ue>0?(10*Math.log10(be/ue)).toFixed(1):"âˆž"})()}},[t,s,p,h,m,d,f,o,l,M,x,b]),U=S.useMemo(()=>qt(y.t,{I:y.filteredI,Q:y.filteredQ}),[y]),R=S.useMemo(()=>{const u=y.inputSpectrum.frequencies,A=y.inputSpectrum.db,E=a*.5,k=a-E,B=a+E,C=[],_=Math.max(1,Math.floor(u.length/500));for(let F=0;F<u.length;F+=_)u[F]>=k&&u[F]<=B&&C.push({f:u[F],mag:A[F]});return C},[y,a]),ee=S.useMemo(()=>ze(y.rawIQSpectrum.frequencies,y.rawIQSpectrum.db),[y]),L=S.useMemo(()=>ze(y.filteredIQSpectrum.frequencies,y.filteredIQSpectrum.db),[y]),W=S.useMemo(()=>{const u=y.inputSpectrum.frequencies,A=y.inputSpectrum.db,E=y.reconstructedSpectrum.frequencies,k=y.reconstructedSpectrum.db,B=a*.5,C=a-B,_=a+B,te=Math.max(1,Math.floor(u.length/500)),ne=[];for(let T=0;T<u.length;T+=te)u[T]>=C&&u[T]<=_&&ne.push({f:u[T],original:A[T],reconstructed:T<E.length?k[T]:-80});return ne},[y,a]),G=u=>{n(u.target.value)};return e.jsxs("div",{className:"app",children:[e.jsxs("header",{className:"app-header",children:[e.jsx("h1",{children:"Quadrature Signal Lab â€” Real"}),e.jsxs("p",{children:["Realistic ",e.jsx("span",{style:{color:"#2563eb"},children:"I"}),"/",e.jsx("span",{style:{color:"#dc2626"},children:"Q"})," receiver pipeline with frequency domain and filtering"]})]}),e.jsxs("div",{className:"section-card",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"ðŸ“¡ Input Signal"}),e.jsx("p",{className:"section-desc",children:"The input RF signal â€” as seen by an antenna"})]}),e.jsxs("div",{className:"section-content",children:[e.jsxs("div",{className:"subsection",children:[e.jsx("h3",{className:"subsection-title",children:"âš™ï¸ Signal Parameters"}),e.jsxs("div",{className:"controls-grid",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Signal Type"}),e.jsxs("select",{value:t,onChange:G,children:[e.jsx("option",{value:"tone",children:"Pure Tone"}),e.jsx("option",{value:"am",children:"AM"}),e.jsx("option",{value:"fm",children:"FM (Broadcast)"})]})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Carrier Frequency"}),e.jsx("input",{type:"range",min:50,max:500,step:10,value:i,onChange:u=>r(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[i," MHz"]})]}),t!=="tone"&&e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Modulating Frequency"}),e.jsx("input",{type:"range",min:1e3,max:5e4,step:1e3,value:o,onChange:u=>c(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[(o/1e3).toFixed(0)," kHz"]})]})]})]}),e.jsxs("div",{className:"subsection",children:[e.jsx("h3",{className:"subsection-title",children:"RF Spectrum"}),e.jsx(ae,{data:R,freqUnit:"MHz",color:I.input,height:200})]})]})]}),e.jsxs("div",{className:"section-card",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"âš¡ I/Q Downconversion"}),e.jsxs("p",{className:"section-desc",children:["Mix with local oscillator at ",i," MHz, then filter to extract the baseband signal"]})]}),e.jsxs("div",{className:"section-content",children:[e.jsxs("div",{className:"subsection",children:[e.jsx("h3",{className:"subsection-title",children:"After Mixing â€” Raw Baseband"}),e.jsx("p",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:12},children:"The input signal has been multiplied by cos and âˆ’sin at the carrier frequency, shifting everything down to baseband. Notice the spike near 0 Hz â€” that's your actual signal content. But there's also an unwanted copy far to the left at twice the carrier frequency (the mixing image). The low-pass filter in the next step removes it. The same thing happens in every real receiver â€” the analog or digital LPF (low-pass filter) after the mixer is specifically there to kill that image. Without it, the double-frequency component would corrupt your I/Q data and make the constellation diagram messy."}),e.jsx("div",{className:"controls-grid",style:{marginBottom:12},children:e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Receiver Noise"}),e.jsx("input",{type:"range",min:0,max:1,step:.01,value:b,onChange:u=>v(Number(u.target.value))}),e.jsx("span",{className:"control-value",children:b.toFixed(2)})]})}),e.jsx(ae,{data:ee,freqUnit:"MHz",color:I.I,height:200})]}),e.jsxs("div",{className:"subsection",children:[e.jsx("h3",{className:"subsection-title",children:"ðŸ”§ After Low-Pass Filter"}),e.jsxs("p",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:12},children:["A windowed-sinc filter at ",(g/1e3).toFixed(0)," kHz with ",x,` taps has removed the double-frequency image, leaving only the clean baseband signal. Compare this with the raw spectrum above â€” the high-frequency spike is gone. What remains is just the modulation content sitting within a narrow band around 0 Hz. The carrier itself became DC during downconversion â€” it's been "mixed away." For FM, that bandwidth is determined by the frequency deviation (Â±75 kHz for broadcast). For AM, it's simply the modulating frequency. This is also where the ADC (analog-to-digital converter) samples the signal. Because the baseband bandwidth is so much narrower than the original RF, the ADC only needs to run at a fraction of the speed â€” hundreds of kHz instead of hundreds of MHz. This is what makes SDR, Wi-Fi, 4G/5G, GPS, radar, and satellite communications practical: all the demodulation, decoding, and classification happens on this filtered I/Q data.`]}),e.jsxs("div",{className:"controls-grid",style:{marginBottom:12},children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Filter Bandwidth"}),e.jsx("input",{type:"range",min:5e4,max:5e5,step:1e4,value:g,onChange:u=>j(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[(g/1e3).toFixed(0)," kHz"]})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Filter Taps"}),e.jsx("input",{type:"range",min:11,max:501,step:10,value:x,onChange:u=>w(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[x," taps"]})]})]}),e.jsx(ae,{data:L,freqUnit:"MHz",color:I.I,height:200})]}),e.jsxs("div",{className:"subsection",children:[e.jsx("p",{className:"chart-desc",style:{marginBottom:8,fontWeight:600},children:"Clean I/Q time domain"}),e.jsxs("p",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:12},children:["This is what the filtered baseband signal looks like over time. The ",e.jsx("strong",{style:{color:"#2563eb"},children:"I"})," channel carries the amplitude envelope and the ",e.jsx("strong",{style:{color:"#dc2626"},children:"Q"})," channel carries the phase offset. For FM, both channels oscillate at the modulating frequency with a 90Â° shift between them. For AM, ",e.jsx("strong",{style:{color:"#2563eb"},children:"I"})," follows the envelope shape while ",e.jsx("strong",{style:{color:"#dc2626"},children:"Q"})," stays near zero. These are the actual samples an SDR streams to your computer."]}),e.jsxs("div",{className:"legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:I.I}}),"I (In-phase)"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:I.Q}}),"Q (Quadrature)"]})]}),e.jsx(ht,{data:U,traces:[{key:"I",color:I.I,label:"I"},{key:"Q",color:I.Q,label:"Q"}]})]})]})]}),e.jsxs("div",{className:"section-card",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"ðŸ”„ Reconstruction"}),e.jsxs("p",{className:"section-desc",children:["Upconvert filtered ",e.jsx("span",{style:{color:"#2563eb"},children:"I"}),"/",e.jsx("span",{style:{color:"#dc2626"},children:"Q"})," back to RF â€” original vs reconstructed spectrum"]})]}),e.jsxs("div",{className:"section-content",children:[e.jsxs("div",{className:"subsection",children:[e.jsx("p",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:16},children:"The SNR measures how faithfully the signal survives the downconvertâ€“filterâ€“upconvert round trip. What affects it:"}),e.jsxs("ul",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.8,marginBottom:16,paddingLeft:20},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Filter quality"})," â€” more taps = sharper rolloff = less distortion at the band edge"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Filter cutoff vs signal bandwidth"})," â€” cutoff must pass all modulation content without clipping it"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Modulation type"})," â€” a pure tone is easiest; wideband FM spreads energy near the filter edge where distortion occurs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Real hardware factors"})," â€” ADC bit depth, oscillator phase noise, and analog imperfections (not modeled here)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Receiver noise"})," â€” thermal noise added before filtering simulates real-world conditions. Crank it up to see how the filter fights noise"]})]}),e.jsx("p",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:8},children:"SNR quality brackets:"}),e.jsxs("ul",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.8,marginBottom:16,paddingLeft:20},children:[e.jsxs("li",{children:[e.jsx("strong",{style:{color:"var(--accent-green)"},children:">40 dB"})," â€” Excellent. Near-perfect reconstruction, suitable for precision measurement"]}),e.jsxs("li",{children:[e.jsx("strong",{style:{color:"var(--accent-green)"},children:"20â€“40 dB"})," â€” Good. Clean enough for reliable demodulation and decoding"]}),e.jsxs("li",{children:[e.jsx("strong",{style:{color:"#ea580c"},children:"10â€“20 dB"})," â€” Marginal. Noticeable distortion, digital comms will see bit errors"]}),e.jsxs("li",{children:[e.jsx("strong",{style:{color:"#dc2626"},children:"<10 dB"})," â€” Poor. Signal heavily degraded, likely unusable for most applications"]})]}),e.jsx("p",{style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:16},children:"Try switching signal types or adjusting the filter below to see the SNR change."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:.5,marginBottom:12},children:"Input Signal"}),e.jsxs("div",{className:"controls-grid",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Signal Type"}),e.jsxs("select",{value:t,onChange:G,children:[e.jsx("option",{value:"tone",children:"Pure Tone"}),e.jsx("option",{value:"am",children:"AM"}),e.jsx("option",{value:"fm",children:"FM (Broadcast)"})]})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Carrier Frequency"}),e.jsx("input",{type:"range",min:50,max:500,step:10,value:i,onChange:u=>r(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[i," MHz"]})]}),t!=="tone"&&e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Modulating Frequency"}),e.jsx("input",{type:"range",min:1e3,max:5e4,step:1e3,value:o,onChange:u=>c(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[(o/1e3).toFixed(0)," kHz"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:.5,marginBottom:12},children:"Filter"}),e.jsxs("div",{className:"controls-grid",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Bandwidth"}),e.jsx("input",{type:"range",min:5e4,max:5e5,step:1e4,value:g,onChange:u=>j(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[(g/1e3).toFixed(0)," kHz"]})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Taps"}),e.jsx("input",{type:"range",min:11,max:501,step:10,value:x,onChange:u=>w(Number(u.target.value))}),e.jsxs("span",{className:"control-value",children:[x," taps"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:.5,marginBottom:12},children:"Noise"}),e.jsx("div",{className:"controls-grid",children:e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Receiver Noise"}),e.jsx("input",{type:"range",min:0,max:1,step:.01,value:b,onChange:u=>v(Number(u.target.value))}),e.jsx("span",{className:"control-value",children:b.toFixed(2)})]})})]})]})]}),e.jsxs("div",{className:"subsection",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("div",{className:"legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:I.input}}),"Original"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:I.output}}),"Reconstructed"]})]}),e.jsxs("div",{style:{fontFamily:"JetBrains Mono, monospace",fontSize:13,color:parseFloat(y.reconstructionSNR)>20?"var(--accent-green)":parseFloat(y.reconstructionSNR)>10?"#ea580c":"#dc2626",background:"var(--bg-secondary)",padding:"4px 12px",borderRadius:6},children:["SNR: ",y.reconstructionSNR," dB"]})]}),e.jsx(ae,{data:W,freqUnit:"MHz",height:200,traces:[{key:"original",color:I.input,label:"Original"},{key:"reconstructed",color:I.output,label:"Reconstructed"}]})]})]})]}),e.jsxs("div",{className:"section-card",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"ðŸŽ¯ I/Q Constellation"}),e.jsxs("p",{className:"section-desc",children:[e.jsx("span",{style:{color:"#dc2626"},children:"Q"})," vs ",e.jsx("span",{style:{color:"#2563eb"},children:"I"})," â€” with filtering, the true modulation shape is revealed"]})]}),e.jsx("div",{className:"section-content",children:e.jsxs("div",{className:"subsection",children:[e.jsxs("p",{className:"chart-desc",style:{fontSize:14,color:"var(--text-secondary)",lineHeight:1.6,marginBottom:12},children:["Each point is one instant of the signal as a complex number (",e.jsx("strong",{style:{color:"#2563eb"},children:"I"})," + j",e.jsx("strong",{style:{color:"#dc2626"},children:"Q"}),"). With proper filtering, the constellation reveals the modulation type. Try switching the input signal to see the difference:",e.jsx("br",{}),e.jsx("strong",{children:"Pure tone"})," â†’ single point (fixed amplitude and phase)",e.jsx("br",{}),e.jsx("strong",{children:"AM"})," â†’ line (amplitude changes, phase stays constant)",e.jsx("br",{}),e.jsx("strong",{children:"FM"})," â†’ circle (constant amplitude, rotating phase)",e.jsx("br",{}),e.jsx("strong",{children:"BPSK"})," â†’ two points (real systems)",e.jsx("br",{}),e.jsx("strong",{children:"QPSK"})," â†’ four points in a square (real systems)",e.jsx("br",{}),e.jsx("strong",{children:"16-QAM"})," â†’ 4Ã—4 grid (real systems)",e.jsx("br",{}),e.jsx("strong",{children:"Noise"})," â†’ random cloud around the origin"]}),e.jsx(Bt,{I:Array.from(y.filteredI),Q:Array.from(y.filteredQ),color:I.output,size:350})]})})]}),e.jsxs("footer",{style:{textAlign:"center",padding:"20px",color:"var(--text-secondary)",fontSize:13},children:["Quadrature Signal Lab â€”"," ",e.jsx("a",{href:"../simple/",style:{color:"var(--accent-blue)"},children:"Switch to Simple version"})]})]})}pt.createRoot(document.getElementById("root")).render(e.jsx(P.StrictMode,{children:e.jsx(Rt,{})}));
